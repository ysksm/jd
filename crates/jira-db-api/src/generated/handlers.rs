// Generated by @jira-db/emit-rust - DO NOT EDIT

use std::sync::Arc;

use axum::{
    extract::State,
    routing::post,
    Json, Router,
};

use super::types::*;
use crate::error::ApiError;
use crate::handlers;
use crate::state::AppState;

/// Create router with all API endpoints
pub fn create_router() -> Router<Arc<AppState>> {
    Router::new()
        .route("/config.get", post(config_get))
        .route("/config.update", post(config_update))
        .route("/config.initialize", post(config_initialize))
        .route("/projects.list", post(projects_list))
        .route("/projects.initialize", post(projects_initialize))
        .route("/projects.enable", post(projects_enable))
        .route("/projects.disable", post(projects_disable))
        .route("/sync.execute", post(sync_execute))
        .route("/sync.status", post(sync_status))
        .route("/issues.search", post(issues_search))
        .route("/issues.get", post(issues_get))
        .route("/issues.history", post(issues_history))
        .route("/metadata.get", post(metadata_get))
        .route("/embeddings.generate", post(embeddings_generate))
        .route("/embeddings.search", post(embeddings_search))
        .route("/reports.generate", post(reports_generate))
        .route("/sql.execute", post(sql_execute))
        .route("/sql.get-schema", post(sql_get_schema))
        .route("/sql.list-queries", post(sql_list_queries))
        .route("/sql.save-query", post(sql_save_query))
        .route("/sql.delete-query", post(sql_delete_query))
}

// ============================================================
// Handler Functions
// ============================================================

// -- Config --

/// Get current configuration
async fn config_get(
    State(state): State<Arc<AppState>>,
    Json(request): Json<ConfigGetRequest>,
) -> Result<Json<ConfigGetResponse>, ApiError> {
    handlers::config::get(state, request).await
}

/// Update configuration
async fn config_update(
    State(state): State<Arc<AppState>>,
    Json(request): Json<ConfigUpdateRequest>,
) -> Result<Json<ConfigUpdateResponse>, ApiError> {
    handlers::config::update(state, request).await
}

/// Initialize configuration
async fn config_initialize(
    State(state): State<Arc<AppState>>,
    Json(request): Json<ConfigInitRequest>,
) -> Result<Json<ConfigInitResponse>, ApiError> {
    handlers::config::initialize(state, request).await
}

// -- Projects --

/// List all projects
async fn projects_list(
    State(state): State<Arc<AppState>>,
    Json(request): Json<ProjectListRequest>,
) -> Result<Json<ProjectListResponse>, ApiError> {
    handlers::projects::list(state, request).await
}

/// Initialize projects from JIRA
async fn projects_initialize(
    State(state): State<Arc<AppState>>,
    Json(request): Json<ProjectInitRequest>,
) -> Result<Json<ProjectInitResponse>, ApiError> {
    handlers::projects::initialize(state, request).await
}

/// Enable project sync
async fn projects_enable(
    State(state): State<Arc<AppState>>,
    Json(request): Json<ProjectEnableRequest>,
) -> Result<Json<ProjectEnableResponse>, ApiError> {
    handlers::projects::enable(state, request).await
}

/// Disable project sync
async fn projects_disable(
    State(state): State<Arc<AppState>>,
    Json(request): Json<ProjectDisableRequest>,
) -> Result<Json<ProjectDisableResponse>, ApiError> {
    handlers::projects::disable(state, request).await
}

// -- Sync --

/// Execute sync for enabled projects
async fn sync_execute(
    State(state): State<Arc<AppState>>,
    Json(request): Json<SyncExecuteRequest>,
) -> Result<Json<SyncExecuteResponse>, ApiError> {
    handlers::sync::execute(state, request).await
}

/// Get sync status
async fn sync_status(
    State(state): State<Arc<AppState>>,
    Json(request): Json<SyncStatusRequest>,
) -> Result<Json<SyncStatusResponse>, ApiError> {
    handlers::sync::status(state, request).await
}

// -- Issues --

/// Search issues with filters
async fn issues_search(
    State(state): State<Arc<AppState>>,
    Json(request): Json<IssueSearchRequest>,
) -> Result<Json<IssueSearchResponse>, ApiError> {
    handlers::issues::search(state, request).await
}

/// Get issue by key
async fn issues_get(
    State(state): State<Arc<AppState>>,
    Json(request): Json<IssueGetRequest>,
) -> Result<Json<IssueGetResponse>, ApiError> {
    handlers::issues::get(state, request).await
}

/// Get issue change history
async fn issues_history(
    State(state): State<Arc<AppState>>,
    Json(request): Json<IssueHistoryRequest>,
) -> Result<Json<IssueHistoryResponse>, ApiError> {
    handlers::issues::history(state, request).await
}

// -- Metadata --

/// Get project metadata
async fn metadata_get(
    State(state): State<Arc<AppState>>,
    Json(request): Json<MetadataGetRequest>,
) -> Result<Json<MetadataGetResponse>, ApiError> {
    handlers::metadata::get(state, request).await
}

// -- Embeddings --

/// Generate embeddings for semantic search
async fn embeddings_generate(
    State(state): State<Arc<AppState>>,
    Json(request): Json<EmbeddingsGenerateRequest>,
) -> Result<Json<EmbeddingsGenerateResponse>, ApiError> {
    handlers::embeddings::generate(state, request).await
}

/// Semantic search using embeddings
async fn embeddings_search(
    State(state): State<Arc<AppState>>,
    Json(request): Json<SemanticSearchRequest>,
) -> Result<Json<SemanticSearchResponse>, ApiError> {
    handlers::embeddings::search(state, request).await
}

// -- Reports --

/// Generate HTML report
async fn reports_generate(
    State(state): State<Arc<AppState>>,
    Json(request): Json<ReportGenerateRequest>,
) -> Result<Json<ReportGenerateResponse>, ApiError> {
    handlers::reports::generate(state, request).await
}

// -- Sql --

/// Execute SQL query (read-only)
async fn sql_execute(
    State(state): State<Arc<AppState>>,
    Json(request): Json<SqlExecuteRequest>,
) -> Result<Json<SqlExecuteResponse>, ApiError> {
    handlers::sql::execute(state, request).await
}

/// Get database schema
async fn sql_get_schema(
    State(state): State<Arc<AppState>>,
    Json(request): Json<SqlGetSchemaRequest>,
) -> Result<Json<SqlGetSchemaResponse>, ApiError> {
    handlers::sql::get_schema(state, request).await
}

/// List saved queries
async fn sql_list_queries(
    State(state): State<Arc<AppState>>,
    Json(request): Json<SqlQueryListRequest>,
) -> Result<Json<SqlQueryListResponse>, ApiError> {
    handlers::sql::list_queries(state, request).await
}

/// Save a query
async fn sql_save_query(
    State(state): State<Arc<AppState>>,
    Json(request): Json<SqlQuerySaveRequest>,
) -> Result<Json<SqlQuerySaveResponse>, ApiError> {
    handlers::sql::save_query(state, request).await
}

/// Delete a saved query
async fn sql_delete_query(
    State(state): State<Arc<AppState>>,
    Json(request): Json<SqlQueryDeleteRequest>,
) -> Result<Json<SqlQueryDeleteResponse>, ApiError> {
    handlers::sql::delete_query(state, request).await
}

